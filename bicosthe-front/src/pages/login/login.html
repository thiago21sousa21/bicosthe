<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Login</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
  <h1>Login</h1>

  <form id="loginForm">
    <label>Email:
      <input type="email" name="email" required>
    </label><br><br>

    <label>Senha:
      <input type="password" name="senha" required>
    </label><br><br>

    <button type="submit">Entrar</button>
  </form>

  <div id="resposta" style="margin-top: 20px; font-weight: bold;"></div>

  <script>
    document.getElementById('loginForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const form = e.target;
      const email = form.email.value.trim();
      const senha = form.senha.value;

      try {
        const response = await axios.post('http://localhost:5000/signin', {
          email,
          senha
        });

        const { token, idsession, idusuario } = response.data;

        // Salva no localStorage
        localStorage.setItem('token', token);
        localStorage.setItem('idsession', idsession);
        localStorage.setItem('idusuario', idusuario)

        document.getElementById('resposta').innerText = '✅ Login realizado com sucesso!';

        // Redirecionar para a página principal (opcional)
        // window.location.href = 'pagina-principal.html';

      } catch (error) {
        console.error(error);
        const mensagem = error.response?.data?.message || 'Erro ao fazer login.';
        document.getElementById('resposta').innerText = '❌ ' + mensagem;
      }
    });
  </script>
</body>
</html>
